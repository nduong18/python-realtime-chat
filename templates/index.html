<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PTIT Realtime Chat</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/mini.css@3.0.1/dist/mini-default.min.css"
    />
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body
    data-current-user="{{ username or '' }}"
    data-room="{{ room or '' }}"
    data-partner="{{ partner or '' }}"
  >
    <div class="app-shell">
      <aside id="sidebar" class="sidebar">
        <div
          class="sidebar-header"
          style="
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: space-between;
          "
        >
          <div style="font-weight: 700">Trò chuyện</div>
          <div style="display: flex; gap: 8px; align-items: center">
            {% if username %}
            <div class="add-friend-wrap">
              <a
                class="btn small add-friend-btn"
                href="/friends"
                title="Add friend"
                aria-label="Add friend"
                >Bạn bè</a
              >
            </div>
            {% endif %}
          </div>
        </div>
        <div id="sidebar-body"></div>
      </aside>
      <div class="main-content">
        <header class="topbar">
          <div class="topbar-left">
            <h1 class="app-title">PTIT Realtime Chat</h1>
            <div class="app-sub">App chat của sinh viên PTIT</div>
          </div>
          <div class="topbar-right">
            {% if username %}
            <div class="ctrl">Chào, {{ username }}</div>
            <div class="collapse-control">Mở/Ẩn Sidebar</div>
            <a class="btn small" href="/logout">Đăng xuất</a>
            {% else %} {% endif %}
          </div>
        </header>

        <main class="chat-wrap">
          <section class="chat-area">
            <div id="messages" class="messages"></div>
          </section>

          <footer class="chat-input">
            <form id="chatForm" class="input-form">
              <div
                style="
                  display: flex;
                  gap: 8px;
                  align-items: center;
                  width: 100%;
                "
              >
                <input
                  id="msgInput"
                  class="msg"
                  placeholder="Nhập tin nhắn..."
                  autocomplete="off"
                  style="flex: 1"
                />
                <div class="emoji-wrap" style="position: relative">
                  <button type="button" id="emojiBtn" class="btn small">
                    😊
                  </button>
                  <div
                    id="emojiPicker"
                    class="emoji-picker"
                    style="
                      display: none;
                      position: absolute;
                      right: 0;
                      bottom: 44px;
                      background: #fff;
                      border: 1px solid #e6eef8;
                      padding: 8px;
                      border-radius: 8px;
                      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
                    "
                  >
                    <button type="button" class="emoji-item">😀</button>
                    <button type="button" class="emoji-item">😁</button>
                    <button type="button" class="emoji-item">😂</button>
                    <button type="button" class="emoji-item">😅</button>
                    <button type="button" class="emoji-item">😍</button>
                    <button type="button" class="emoji-item">😎</button>
                    <button type="button" class="emoji-item">👍</button>
                    <button type="button" class="emoji-item">🙏</button>
                    <button type="button" class="emoji-item">🎉</button>
                    <button type="button" class="emoji-item">✅</button>
                    <button type="button" class="emoji-item">💖</button>
                    <button type="button" class="emoji-item">💓</button>
                    <button type="button" class="emoji-item">🩷</button>
                    <button type="button" class="emoji-item">🌻</button>
                    <button type="button" class="emoji-item">🧑‍💻</button>
                  </div>
                </div>
                <button class="send">Gửi</button>
              </div>
            </form>
          </footer>
        </main>
      </div>
    </div>
    {% if partner %} {% endif %}

    <script src="https://cdn.socket.io/4.7.1/socket.io.min.js"></script>
    <script src="/static/chat.js"></script>
  </body>
</html>
